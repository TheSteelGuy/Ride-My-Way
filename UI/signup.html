
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Signup</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" media="screen" href="main.css" />
    <script src="main.js"></script>
</head>

<body>
    <div id="wrapper">
        <!--begin wrapper-->
        <div id="header">
            <ul>
                <li>
                    <a href="#">Home</a>
                </li>

                <li>
                    <a href="available_rides.html">Available Rides</a>
                </li>
                <li id="right">
                    <a class="active" href="signup.html">Sign Up</a>
                </li>
                <li id="right">
                    <a href="login.html">Sign In</a>
                </li>
            </ul>
        </div>
        <div id="body">
            <div class="intr">
                <div id="form">
                    <h3 id="alert"></h3>
                    <div class="form_title">
                        <h3>Sign up details</h3>
                    </div>
                    <form id="signupform" action="" method="POST">
                        <label for="username">Username</label>
                        <input type="text" name="uname" id="username" required>
                        <label for="phone">Phone Contact</label>
                        <input type="text" name="phone" id="phone"required>
                        <label for="password">Password</label>
                        <input type="password" name="pwd" id="pwd" required>
                        <label for="password">Confirm Password</label>
                        <input type="password" name="cpwd" id="cpwd" required>
                        <p>Already a member?
                            <a href="login.html">Login</a>
                        </p>
                        <input type="submit" value="Sign Up">
                    </form>
                    <p id="try">try</p>
                    <script>
                        const signupForm = document.getElementById("signupform");
                        signupForm.addEventListener("submit", function(event) {
                            event.preventDefault();
                                var request = new XMLHttpRequest();
                                var url = "https://mighty-beach-21248.herokuapp.com/api/v1/auth/signup";
                                request.open("POST", url, true);
                                request.setRequestHeader("Content-Type", "application/json");
                                request.onreadystatechange = function () {
                                    if (request.readyState === 4 && request.status === 201) {
                                        let res = JSON.parse(request.response);
                                        document.getElementById("try").innerHTML=res.auth_token;
                                    }
                                    else{
                                        message = JSON.parse(request.responseText)
                                        document.getElementById("alert").innerHTML=message.message;
                                    }
                                    
                                };
                                let username =  document.getElementById("username").value;
                                let phone = document.getElementById("phone").value;
                                let password = document.getElementById("pwd").value;
                                let confirm_pwd = document.getElementById("cpwd").value;
                                let data = JSON.stringify({"username": username, "phone": phone, "password": password, "confirm_pwd": confirm_pwd});
                                request.send(data);
                                
                                
                        });  
                    </script>
            </div>
        </div>
        <div id="footer">
            <p>&copy Ridemyway.All rights reserved </p>
        </div>
    </div>
    <!--end of wrapper-->
</body>

</html>
